---
title: "Practical courses"
author: "Amin Madoui and Romuald Laso-Jadart"
date: "April 2021"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#   Estimation of the genomic differentiation
##    Allele frequency spectrum

 ```{r}
 data=read.table('data/RC/S155.txt')
 colnames(data) = c("GA","GB","TA","TB")
 Gfreq = data$GB/(data$GA+data$GB)
 hist(Gfreq, breaks = 10, main="B allele frequency distribution")
 ```
 ##Pairwise-FST
 ```{r}
source ("popgene_functions.R")
 
freq = read.table("data/Genomic_frequencies.txt")
colnames(freq) = c("S155","S158","S178","S206","S208","S209","S210")

pairwiseFST = pwFst(freq)

print(pairwiseFST)
 
plotFST(pairwiseFST)
 ```
 
 ##Isolation by currents   
 
 
 # Detection of loci under natural selection
 
 ##FST outliers method through LK
  ```{r}
source ("popgene_functions.R")
 
freq = read.table("data/Genomic_frequencies.txt")
colnames(freq) = c("S155","S158","S178","S206","S208","S209","S210")

LK = LK(freq)
head( LK)

h = hist ( LK$LK , plot = F, breaks = 50 )
n_pop = ncol(freq)-1
max1 = max ( h$density )
max2 = max ( dchisq (seq(0:max(LK$LK)), n_pop ))
Max = max (max1, max2) + 0.1
hist ( LK$LK, freq = F, xlab = "LK" , ylim = c(0,Max) , breaks = 50 , main = "")
x <- NULL; rm(x)

# add the neutral evolution
curve ( dchisq( x, n_pop ) , lwd=3, col="orange" , add=T )
 ```
 
 ##pcadapt method
 #Population-scale allele expression
 ##Comparison of allele expression to genomic abundance
 ##Detection of allele-specific expression
 ##Link between natural selection and allele specific ex-pression
 #Reference-free approach and metavariant species
 ##Genomic differentiation of MVS
 ##Role of the environmental factors
 ##Variance partitioning of environmental factors


```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
